# 開発ルール（CONTRIBUTING）

このドキュメントはこのリポジトリで従うべき開発ルールを日本語でまとめたものです。
プロジェクトの一貫性・品質を保つため、実装前に必ず確認してください。

※ すべての記載は日本語で行ってください。

## 1. 基本方針
- 新しい機能や修正は必ずブランチを切って開発すること。ブランチ名の例: `feature/*`, `fix/*`, `refactor/*`。
- 直接 `main` ブランチへコミット/マージしない。メインへのマージは明示的な指示があるまで行わない。
- 実装前に計画（目的、影響範囲、再利用する既存コンポーネント、テスト計画）を作成し、`/docs` に保存して承認を得ること。

## 2. ドキュメント
- すべての要求・設計は `/docs` にログとして残すこと。
- 変更点や追加仕様は PR と同時にドキュメントを更新すること。

## 3. コーディング方針
- コンポーネント設計は Atomic Design（Atoms / Molecules / Organisms / Templates / Pages）に従う。
- 既存の再利用可能なコンポーネントがある場合は必ず流用する。
- 単一責任の原則を守り、コンポーネントは小さく分割する。
- アクセシビリティに配慮する（ARIA、キーボード操作、フォーカス制御）。

## 4. スタイリング
- Tailwind CSS を第一選択とする。独自 CSS は必要最低限に留める。
- 独自 CSS を使う場合は BEM 命名規則を利用し、理由をコメントで残す。
- 絵文字アイコンの使用は禁止。単色 SVG（`stroke="currentColor"` / `fill="currentColor"`）を利用する。

## 5. テストと開発フロー
- TDD（テスト駆動開発）を徹底する：テスト（単体／統合／E2E）を先に書き、Red → Green → Refactor のサイクルを完了してからマージする。
- Jest を用いたユニットテストはカバレッジ閾値（global 60%）を目標とする。
- Playwright / Cypress による E2E テストを重要視する。CI 環境では複数ブラウザで実行する。

## 6. Git とコミットメッセージ
- コミットメッセージは日本語で、次の形式を推奨：
  `feat: 商品一覧ページにフィルター機能を追加`
- メッセージには実装の要点、影響範囲、関連ドキュメントの参照を含めること。
- 変更は意味のある単位でステージングし、関連するファイルをまとめてコミットする。

## 7. マージ前チェック（必須）
1. テスト（`npm test`）を実行し、失敗がないことを確認する。
2. E2E（`npm run test:e2e` / Playwright）を実行し、主要フローが通ることを確認する。
3. `npm run build` が成功することを確認する（TypeScript エラー 0 を目指す）。
4. Lighthouse の主要指標（Performance/Accessibility/Best Practices/SEO）が各 90 以上であることを計画段階とマージ前に確認する。 
5. Red-Green-Refactor サイクルが完了していることをコミットメッセージや PR に明記する。

> 重要: 上記を満たしても、`main` へのマージはリポジトリ管理者または指定ユーザーの明示的な承認があるまで行わない。

## 8. SSR とクライアントコード
- ブラウザ専用 API（localStorage など）は必ず `typeof window !== 'undefined'` で保護する。
- クライアントでのみ動作するコンポーネントは `'use client'` を明示する。

## 9. UI/UX 開発ルール
- UI/UX 影響がある作業は計画段階でデザイナーのレビューを入れること（レビューはエージェントが合意で代行可能だが、最終デザインはデザイナー承認を推奨）。
- 新しいページ作成時は既存ページのテンプレートを参照して作ること。
- レスポンシブ対応を前提にコンポーネントを設計すること。

## 10. 機能固有ルール（クイックオーダー等）
- クイックオーダーなど重要なビジネス機能は仕様書（`/docs`）に従うこと。
- 商品コードを入力したら商品画像と商品名を各行に表示し、行の縦サイズを短縮する（タイトルは非表示）。
- デモデータ入力ボタンは左側に配置する。

## 11. ヘッダー / ナビゲーション
- ヘッダーに「注文履歴」「承認（件数）」を表示する。ドロワーにも同等のメニューを追加し、ドロワー内のメニューはユーザーが選択したものをヘッダーのカスタムメニュー領域へ反映できること。

## 12. パフォーマンス要件
- Lighthouse のスコアを計画時とテスト時にチェックし、各カテゴリ 90 以上を目指す。

## 13. 環境・実行コマンド（参考）
- 開発サーバー: `npm run dev`
- ビルド: `npm run build`
- ユニットテスト: `npm test`
- E2E (Playwright): `npm run test:e2e`
- Lint: `npm run lint`

## 14. 追加要望・運用
- 変更で阻害要因がある場合は専用ブランチを切り、調査・修正を行う。
- S3 にアップロードして公開するモックは可能な限り作成する。最終実装はエンジニアが行う。

---
このファイルは CLAUDE.md や `/docs` の内容を元に作成しました。必要があればさらに詳細（コミットテンプレート、PR テンプレート、CI ワークフローなど）を追加します。
